<!DOCTYPE html>
<html>
  <head><meta name="generator" content="Hexo 3.9.0">
    
    <meta charset="utf-8">
    <meta name="baidu-site-verification" content="vvVgSQUzPU">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="undefined">
     
    <meta name="description" content="null">
    
    <title>
      2018北邮自招复试-CTF-Writeup - ios&#39;s blog
    </title>
    <link rel="manifest" href="/manifest.json">
    <link rel="shortcut icon" href="undefined" type="image/x-icon">
    <link rel="stylesheet" href="/style/style.css">
  </head>
  <body>
    <div id="fixed-menu">
      <span class="iconfont icon-arrowup"></span>
    </div>
    <div id="progress">
      <div class="line"></div>
    </div>
    <!-- <div id="search-wrap">
      <input type="text" placeholder="Search Keys"/>

      <div class="result"></div>
    </div> -->
    <div id="head">
      
      <a href="/" class="">
        首页
      </a>
      
      <a href="/archives" class="">
        归档
      </a>
      
      <a href="/about" class="">
        关于
      </a>
      
      <a href="/link" class="">
        友情链接
      </a>
      
    </div>
    <div id="container">
      <div id="main">
        <div class="navbar">
          <div class="toggle">
            <span class="iconfont icon-menu toggle-icon"></span>
          </div>
          <div class="search">
            <div class="input-warp">
              <!-- <span class="iconfont icon-sousuo"></span> -->
              <input type="text" name="" class="st-default-search-input" id="site-search" placeholder="Search Keys">
            </div>
          </div>
        </div>
        <div class="content">
          <article class="post-entry">
    <div class="header">
      <div class="title">2018北邮自招复试-CTF-Writeup</div>
      <div class="meta">
        <span class="item">
          <span class="iconfont icon-time-circle"></span>
          <span>2018/06/10</span>
        </span>

        
        
         
          <span class="item">
            <span class="iconfont icon-tag1"></span>
            <span>
                
                  
                    <a href="/tags/writeup">writeup</a>
                  
                
                  
                    <a href="/tags/RE">RE</a>
                  
                
                  
                    <a href="/tags/WEB">WEB</a>
                  
                
                  
                    <a href="/tags/BUPT">BUPT</a>
                  
                
            </span>
          </span>
         

        
          <span class="item leancloud-visitors" id="/2018/06/10/2018北邮自招复试-CTF-Writeup/" data-flag-title="2018北邮自招复试-CTF-Writeup">
            <span class="iconfont icon-eye1"></span>
            <span class="leancloud-visitors-count"></span>
          </span>
        
      </div>
      <div>
      </div>
    </div>
    <h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><p>右键查看网站源码</p>
<p></p><p class="code-caption" data-lang="html" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="" data-labels_right="" data-labels_copy=""><span class="code-caption-label"></span></p><p></p>
<pre class=" language-html"><code class="language-html">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/html;charset<span class="token punctuation">=</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>

        <span class="token comment" spellcheck="true">&lt;!--
        index.php
        &lt;?php     
        $flag='xxx';     
        extract($_GET);     
        if(isset($gift)){        
            $content=trim(file_get_contents($flag));
            if($gift==$content){ 
               echo'flag';     }
             else{       
               echo'flag has been encrypted';}   
             } 
        ?>
        --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<p>发现hint 存在flag这个文件 读入到content<br>输入gift 如果 gift=content则输出flag<br>尝试访问</p>
<p></p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="" data-labels_right="" data-labels_copy=""><span class="code-caption-label"></span></p><p></p>
<pre><code>http://10.112.163.9:8888/web2/index.php?gift=
</code></pre><p>返回</p>
<p></p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="" data-labels_right="" data-labels_copy=""><span class="code-caption-label"></span></p><p></p>
<pre><code>Warning: file_get_contents(xxx): failed to open stream: No such file or directory in /var/www/html/web2/index.php on line 6
flag is OHCG{82s5r276o3006q2054048p6799op543q}
</code></pre><p>根据提示 flag has been encrypted<br>所以猜测flag被某种方式加密<br>猜测为凯撒加密<br>用工具爆破了一下</p>
<p></p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="" data-labels_right="" data-labels_copy=""><span class="code-caption-label"></span></p><p></p>
<pre><code>PIDH{82t5s276p3006r2054048q6799pq543r}

QJEI{82u5t276q3006s2054048r6799qr543s}

RKFJ{82v5u276r3006t2054048s6799rs543t}

SLGK{82w5v276s3006u2054048t6799st543u}

TMHL{82x5w276t3006v2054048u6799tu543v}

UNIM{82y5x276u3006w2054048v6799uv543w}

VOJN{82z5y276v3006x2054048w6799vw543x}

WPKO{82a5z276w3006y2054048x6799wx543y}

XQLP{82b5a276x3006z2054048y6799xy543z}

YRMQ{82c5b276y3006a2054048z6799yz543a}

ZSNR{82d5c276z3006b2054048a6799za543b}

ATOS{82e5d276a3006c2054048b6799ab543c}

BUPT{82f5e276b3006d2054048c6799bc543d} //flag

CVQU{82g5f276c3006e2054048d6799cd543e}

DWRV{82h5g276d3006f2054048e6799de543f}

EXSW{82i5h276e3006g2054048f6799ef543g}

FYTX{82j5i276f3006h2054048g6799fg543h}

GZUY{82k5j276g3006i2054048h6799gh543i}

HAVZ{82l5k276h3006j2054048i6799hi543j}

IBWA{82m5l276i3006k2054048j6799ij543k}

JCXB{82n5m276j3006l2054048k6799jk543l}

KDYC{82o5n276k3006m2054048l6799kl543m}

LEZD{82p5o276l3006n2054048m6799lm543n}

MFAE{82q5p276m3006o2054048n6799mn543o}

NGBF{82r5q276n3006p2054048o6799no543p}

OHCG{82s5r276o3006q2054048p6799op543q}
</code></pre><p>因为提示flag格式为BUPT所以得到flag</p>
<p>BUPT{82f5e276b3006d2054048c6799bc543d}</p>
<h2 id="计算题"><a href="#计算题" class="headerlink" title="计算题"></a>计算题</h2><p>题目提示 1s中回答随机产生的数学题<br>运算符号不发生改变 所以用python先取出需要运算的数然后进行运算 最后post提交即可<br>EXP </p>
<p></p><p class="code-caption" data-lang="python" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="" data-labels_right="" data-labels_copy=""><span class="code-caption-label"></span></p><p></p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> urllib2<span class="token punctuation">,</span> urllib

data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'v'</span> <span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">}</span>
f <span class="token operator">=</span> urllib2<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>
        url     <span class="token operator">=</span> <span class="token string">'http://10.112.163.9:8888/web1/index.php'</span><span class="token punctuation">,</span>
        <span class="token comment" spellcheck="true">#data    = urllib.urlencode(data)</span>
  <span class="token punctuation">)</span>
res <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
temp <span class="token operator">=</span> str<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'&lt;br/>'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> temp
res1 <span class="token operator">=</span> temp<span class="token punctuation">[</span>len<span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span> res1
temp <span class="token operator">=</span> str<span class="token punctuation">(</span>res1<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span>
res2 <span class="token operator">=</span> temp<span class="token punctuation">[</span>len<span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span>
<span class="token keyword">print</span> res2
res <span class="token operator">=</span>res2
re1 <span class="token operator">=</span> str<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> re1
a <span class="token operator">=</span> re1<span class="token punctuation">[</span>len<span class="token punctuation">(</span>re1<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span>
re2 <span class="token operator">=</span> re1<span class="token punctuation">[</span>len<span class="token punctuation">(</span>re1<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
re2 <span class="token operator">=</span> str<span class="token punctuation">(</span>re2<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'+'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> re2 
b <span class="token operator">=</span> re2<span class="token punctuation">[</span>len<span class="token punctuation">(</span>re2<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token keyword">print</span> b
q <span class="token operator">=</span> int<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">*</span>int<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token keyword">print</span> q <span class="token operator">//</span>前两位相乘
c <span class="token operator">=</span> re2<span class="token punctuation">[</span>len<span class="token punctuation">(</span>re2<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span> c
re3 <span class="token operator">=</span> re1<span class="token punctuation">[</span>len<span class="token punctuation">(</span>re1<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span> re3
re3 <span class="token operator">=</span> str<span class="token punctuation">(</span>re3<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> re3
re3 <span class="token operator">=</span> re3<span class="token punctuation">[</span>len<span class="token punctuation">(</span>re3<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
re3 <span class="token operator">=</span> str<span class="token punctuation">(</span>re3<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> re3
re3 <span class="token operator">=</span> re3<span class="token punctuation">[</span>len<span class="token punctuation">(</span>re3<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token keyword">print</span> re3
re3 <span class="token operator">=</span> str<span class="token punctuation">(</span>re3<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'+'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> re3
d <span class="token operator">=</span> int<span class="token punctuation">(</span>re3<span class="token punctuation">[</span>len<span class="token punctuation">(</span>re3<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>int<span class="token punctuation">(</span>re3<span class="token punctuation">[</span>len<span class="token punctuation">(</span>re3<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> d <span class="token operator">//</span>括号里面的相加
p <span class="token operator">=</span> int<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">*</span>int<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token keyword">print</span> p <span class="token operator">//</span>括号外相乘
ss <span class="token operator">=</span> int<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">+</span>int<span class="token punctuation">(</span>q<span class="token punctuation">)</span>
<span class="token keyword">print</span> ss <span class="token operator">//</span>执行完整的运算
data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'v'</span> <span class="token punctuation">:</span> ss<span class="token punctuation">}</span>
f <span class="token operator">=</span> urllib2<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>
        url     <span class="token operator">=</span> <span class="token string">'http://10.112.163.9:8888/web1/index.php'</span><span class="token punctuation">,</span>
        data    <span class="token operator">=</span> urllib<span class="token punctuation">.</span>urlencode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token keyword">print</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>运行即可获取flag<br>flag is BUPT{7b28f26afca4bc2654bd83d2a2bdc546}</p>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="Kaisa"><a href="#Kaisa" class="headerlink" title="Kaisa"></a>Kaisa</h2><p>运行程序开了下流程 需要输入flag 通过题目可知应该是凯撒加密题目<br>导入到IDA分析<br>shift+F12搜索字符串</p>
<p></p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="" data-labels_right="" data-labels_copy=""><span class="code-caption-label"></span></p><p></p>
<pre><code>.rdata:0040789E    0000000D    C    KERNEL32.dll
.data:00408035    00000023    C    FAE{Vl1_3L_T3_gPCj_DxlcE_C1Ryt?!?}
.data:00408058    00000017    C    Flag is your input!!!!
.data:00408074    00000014    C    input your flag?\n&gt;&gt;
.data:00408318    00000006    C     \t-\r]
</code></pre><p>发现一个特殊字符串 FAE{Vl1_3L_T3_gPCj_DxlcE_C1Ryt?!?}<br>通过交叉引用定位到关键函数</p>
<p></p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="" data-labels_right="" data-labels_copy=""><span class="code-caption-label"></span></p><p></p>
<pre><code>int result; // eax
char v9[64]; // [esp+Ch] [ebp-40h]

sub_4012C9(aInputYourFlag);
scanf(aS, v9);
v3 = strlen(v9);
v4 = 0;
if ( v3 &gt; 0 )
{
  v5 = byte_408030;
  do
  {
    v6 = v9[v4];
    if ( (unsigned __int8)v6 &lt; 0x61u || (unsigned __int8)v6 &gt; 0x7Au )
    {
      if ( (unsigned __int8)v6 &gt;= 0x41u &amp;&amp; (unsigned __int8)v6 &lt;= 0x5Au )
        v6 = (unsigned __int16)((unsigned __int8)(v6 + v5 - 65) % 26) + 65;
    }
    else
    {
      v6 = (unsigned __int16)((unsigned __int8)(v6 + v5 - 97) % 26) + 97;
    }
    v9[v4++] = v6;
  }
  while ( v4 &lt; v3 );
}
v7 = 0;
if ( v3 &lt;= 0 )
{
LABEL_13:
  sub_4012C9(aFlagIsYourInpu);
  if ( --stru_408088._cnt &lt; 0 )
    _filbuf(&amp;stru_408088);
  else
    ++stru_408088._ptr;
  if ( --stru_408088._cnt &lt; 0 )
    _filbuf(&amp;stru_408088);
  else
    ++stru_408088._ptr;
  result = 0;
}
else
{
  while ( v9[v7] == byte_408034[v7] )
  {
    if ( ++v7 &gt;= v3 )
      goto LABEL_13;
  }
  result = -1;
}
return result;
}
</code></pre><p>查看V5</p>
<p></p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="" data-labels_right="" data-labels_copy=""><span class="code-caption-label"></span></p><p></p>
<pre><code>.data:00408034 byte_408034     db &#39;M&#39;                  ; DATA XREF: _main+95↑r
.data:00408035 aFaeVl13lT3Gpcj db &#39;FAE{Vl1_3L_T3_gPCj_DxlcE_C1Ryt?!?}&#39;,0
.data:00408058 aFlagIsYourInpu db &#39;Flag is your input!!!!&#39;,0
</code></pre><p>找到密文 MFAE{Vl1_3L_T3_gPCj_DxlcE_C1Ryt?!?}<br>通过暴力跑位移得到flag</p>
<p></p><p class="code-caption" data-lang="" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="" data-labels_right="" data-labels_copy=""><span class="code-caption-label"></span></p><p></p>
<pre><code>NGBF{Wm1_3M_U3_hQDk_EymdF_D1Szu?!?}
OHCG{Xn1_3N_V3_iREl_FzneG_E1Tav?!?}
PIDH{Yo1_3O_W3_jSFm_GaofH_F1Ubw?!?}
QJEI{Zp1_3P_X3_kTGn_HbpgI_G1Vcx?!?}
RKFJ{Aq1_3Q_Y3_lUHo_IcqhJ_H1Wdy?!?}
SLGK{Br1_3R_Z3_mVIp_JdriK_I1Xez?!?}
TMHL{Cs1_3S_A3_nWJq_KesjL_J1Yfa?!?}
UNIM{Dt1_3T_B3_oXKr_LftkM_K1Zgb?!?}
VOJN{Eu1_3U_C3_pYLs_MgulN_L1Ahc?!?}
WPKO{Fv1_3V_D3_qZMt_NhvmO_M1Bid?!?}
XQLP{Gw1_3W_E3_rANu_OiwnP_N1Cje?!?}
YRMQ{Hx1_3X_F3_sBOv_PjxoQ_O1Dkf?!?}
ZSNR{Iy1_3Y_G3_tCPw_QkypR_P1Elg?!?}
ATOS{Jz1_3Z_H3_uDQx_RlzqS_Q1Fmh?!?}
BUPT{Ka1_3A_I3_vERy_SmarT_R1Gni?!?} //flag
CVQU{Lb1_3B_J3_wFSz_TnbsU_S1Hoj?!?}
DWRV{Mc1_3C_K3_xGTa_UoctV_T1Ipk?!?}
EXSW{Nd1_3D_L3_yHUb_VpduW_U1Jql?!?}
FYTX{Oe1_3E_M3_zIVc_WqevX_V1Krm?!?}
GZUY{Pf1_3F_N3_aJWd_XrfwY_W1Lsn?!?}
HAVZ{Qg1_3G_O3_bKXe_YsgxZ_X1Mto?!?}
IBWA{Rh1_3H_P3_cLYf_ZthyA_Y1Nup?!?}
JCXB{Si1_3I_Q3_dMZg_AuizB_Z1Ovq?!?}
KDYC{Tj1_3J_R3_eNAh_BvjaC_A1Pwr?!?}
LEZD{Uk1_3K_S3_fOBi_CwkbD_B1Qxs?!?}
MFAE{Vl1_3L_T3_gPCj_DxlcE_C1Ryt?!?}
</code></pre><p>得到flag BUPT{Ka1_3A_I3_vERy_SmarT_R1Gni?!?}</p>
<h2 id="simple"><a href="#simple" class="headerlink" title="simple"></a>simple</h2><p>载入IDA<br>分析了整个流程</p>
<p></p><p class="code-caption" data-lang="c" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="" data-labels_right="" data-labels_copy=""><span class="code-caption-label"></span></p><p></p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// kr04_4</span>
  <span class="token keyword">int</span> result<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// eax</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// esi</span>
  <span class="token keyword">char</span> v6<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// cl</span>
  <span class="token keyword">char</span> v7<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// al</span>
  <span class="token keyword">char</span> v8<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// al</span>
  <span class="token keyword">char</span> v9<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+4h] [ebp-34h]</span>
  <span class="token keyword">char</span> v10<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+5h] [ebp-33h]</span>
  <span class="token keyword">char</span> v11<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+24h] [ebp-14h]</span>
  <span class="token keyword">char</span> v12<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [esp+35h] [ebp-3h]</span>

  v9 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
  <span class="token function">memset</span><span class="token punctuation">(</span>v10<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x30u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v12 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token function">sub_4012E9</span><span class="token punctuation">(</span>aPlzGiveMeYourF<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//输出give me your flag</span>
  <span class="token function">scanf</span><span class="token punctuation">(</span>aS<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v9<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//输入v9</span>
  v3 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//v3 等于v9的长度+1</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">signed</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v3 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">31</span> <span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//判断v9的长度是否大于31</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">signed</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v3 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">40</span> <span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//判断v9的长度是否小于等于40</span>
    <span class="token punctuation">{</span>
      <span class="token function">sub_4012E9</span><span class="token punctuation">(</span>aOkYouCanContin<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//如果上面两个条件满足 则 输出 ok you can continue</span>
      i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      v11 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> v9 <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          v6 <span class="token operator">=</span> byte_408054<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//定义了一个数组到v6</span>
          v7 <span class="token operator">=</span> byte_408030<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">*</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9 <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> __int8<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9 <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//执行运算得到v7</span>
          <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v9 <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">=</span> v7<span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> v7 <span class="token operator">!=</span> v6 <span class="token punctuation">)</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
          v8 <span class="token operator">=</span> v10<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>v8 <span class="token punctuation">)</span>
            <span class="token keyword">goto</span> LABEL_10<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">sub_4012E9</span><span class="token punctuation">(</span>aNononoYourInpu<span class="token punctuation">)</span><span class="token punctuation">;</span>  
LABEL_10<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> i <span class="token operator">==</span> <span class="token number">32</span> <span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//这里提示了flag位数 如果等于32位然后满足 运算过得v7 等于v6 则</span>
          <span class="token function">sub_4012E9</span><span class="token punctuation">(</span>aGoodYouVeGotTh<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//输出 good you have got the flag</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">--</span>stru_408110<span class="token punctuation">.</span>_cnt <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        <span class="token function">_filbuf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>stru_408110<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">else</span>
        <span class="token operator">++</span>stru_408110<span class="token punctuation">.</span>_ptr<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">--</span>stru_408110<span class="token punctuation">.</span>_cnt <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        <span class="token function">_filbuf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>stru_408110<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">else</span>
        <span class="token operator">++</span>stru_408110<span class="token punctuation">.</span>_ptr<span class="token punctuation">;</span>
      result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
    <span class="token punctuation">{</span>
      <span class="token function">sub_4012E9</span><span class="token punctuation">(</span>aTooLong<span class="token punctuation">)</span><span class="token punctuation">;</span>
      result <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span>
  <span class="token punctuation">{</span>
    <span class="token function">sub_4012E9</span><span class="token punctuation">(</span>aTooShort<span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>这里用Z3约束求解</p>
<p></p><p class="code-caption" data-lang="python" data-line_number="frontend" data-trim_indent="backend" data-label_position="outer" data-labels_left="" data-labels_right="" data-labels_copy=""><span class="code-caption-label"></span></p><p></p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>

v6 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">]</span>
v7 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">]</span>
v9 <span class="token operator">=</span> <span class="token punctuation">[</span>BitVec<span class="token punctuation">(</span><span class="token string">"v9%d"</span><span class="token operator">%</span>i<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment" spellcheck="true">#print v9</span>
S <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    S<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v9<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">32</span><span class="token punctuation">)</span>
    S<span class="token punctuation">.</span>add<span class="token punctuation">(</span>v9<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span>
    S<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token punctuation">(</span>v7<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token operator">*</span><span class="token punctuation">(</span>v9<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>v9<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>></span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> v6<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">//</span> 代码处uint8强制类型转换  uint8的上限是<span class="token number">256</span><span class="token operator">-</span><span class="token number">1</span> 下限是<span class="token number">0</span> 所以这里需要<span class="token operator">%</span><span class="token number">256</span> 让他自然溢出

<span class="token keyword">if</span> S<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">:</span>  
    m <span class="token operator">=</span> S<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    flag <span class="token operator">=</span> <span class="token string">''</span> 
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
       flag <span class="token operator">+=</span> chr<span class="token punctuation">(</span>m<span class="token punctuation">[</span>v9<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>as_long<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    
    <span class="token keyword">print</span> flag
</code></pre>


  

  
    <div class="post-reward">
      <div id="reward-button">请杯咖啡呗~</div>
      <div id="qr">
        <div class="wrap">
            
            <div class="bg-wrap">
              <a href="/images/zhifubao.png" target="_block" class="bg" style="background-image:url('/images/zhifubao.png')"></a>
              支付宝
            </div>
            
            
            <div class="bg-wrap">
                <a href="/images/weixin.png" target="_block" class="bg" style="background-image:url('/images/weixin.png')"></a>
              微信
            </div>
            
        </div>
      </div>
    </div>
  
  
  <div class="post-guide">
    <div class="item left">
        
          <a href="2018/06/12/全国中学生网络安全技术大赛-Writeup/"><span class="iconfont icon-left"></span>全国中学生网络安全技术大赛-Writeup</a>
        
    </div>
    <div class="item right">
        
          <a href="2018/06/09/Syclover-Pwn-┴╖╧░╠т/">Syclover-Pwn-练习题<span class="iconfont icon-right"></span></a>
        
    </div>
  </div>

  

  <div class="post-copyright">
    <div class="auth">
      本文作者：<a href="http://iosmosis.github.io">ios</a>
    </div>
    <div class="link">
      永久链接：<a href="http://iosmosis.github.io/2018/06/10/2018北邮自招复试-CTF-Writeup/">http://iosmosis.github.io/2018/06/10/2018北邮自招复试-CTF-Writeup/</a>
    </div>
    <div class="declare">
      版权声明：本文首发于<a href="http://iosmosis.github.io">ios</a>的博客，转载请注明出处！
    </div>
  </div>

  <div id="comment"></div>
</article>
        </div>
        <footer>
          <div class="copyright">
            ©2019 <a href="http://iosmosis.github.io">ios</a>. Powered by
            <a href="https://hexo.io">Hexo</a> &
            <a href="https://github.com/shixiaohu2206/hexo-theme-huhu">hexo-theme-huhu</a>
          </div>
          
        </footer>
      </div>
      <div id="card-wrap">
        <div class="card">
          <div class="logo-widget">
            <div class="author">
              ios
            </div>
            <div class="logo" style="background-image: url('/images/logo.jpeg')"></div>
          </div>
          
          <div class="follow-widget">
            
            <a href="https://github.com/iosmosis" target="_block">
              <span class="iconfont icon-github"></span>
            </a>
            
            <a href="2417117320" target="_block">
              <span class="iconfont icon-QQ"></span>
            </a>
             
            <a href="/atom.xml" target="_block">
              <span class="iconfont icon-rss"></span>
            </a>
            
          </div>
          <div class="category-widget">
            <div class="title">
              <span>Category</span>
            </div>
            <div class="list">
              
            </div>
          </div>
          <div class="tag-widget">
            <div class="title">
              <span>Tag cloud</span>
            </div>
            <div class="tag-cloud">
              <a href="/tags/AI外挂/" style="font-size: 14px; color: #4a4a4a">AI外挂</a> <a href="/tags/About-Me/" style="font-size: 14px; color: #4a4a4a">About Me</a> <a href="/tags/BUPT/" style="font-size: 14px; color: #4a4a4a">BUPT</a> <a href="/tags/CTFwiki/" style="font-size: 14px; color: #4a4a4a">CTFwiki</a> <a href="/tags/Fastbin-Attack/" style="font-size: 16px; color: #4a4a4a">Fastbin_Attack</a> <a href="/tags/Getshell/" style="font-size: 14px; color: #4a4a4a">Getshell</a> <a href="/tags/Heap/" style="font-size: 16px; color: #4a4a4a">Heap</a> <a href="/tags/Hexo/" style="font-size: 14px; color: #4a4a4a">Hexo</a> <a href="/tags/Jarvis-OJ/" style="font-size: 14px; color: #4a4a4a">Jarvis OJ</a> <a href="/tags/MISC/" style="font-size: 14px; color: #4a4a4a">MISC</a> <a href="/tags/NPUCTF/" style="font-size: 14px; color: #4a4a4a">NPUCTF</a> <a href="/tags/Pwn/" style="font-size: 20px; color: #4a4a4a">Pwn</a> <a href="/tags/RE/" style="font-size: 18px; color: #4a4a4a">RE</a> <a href="/tags/ROP/" style="font-size: 14px; color: #4a4a4a">ROP</a> <a href="/tags/ROPgadget/" style="font-size: 14px; color: #4a4a4a">ROPgadget</a>
            </div>
          </div>
           
          <div class="toc-widget">
            <div class="title">
              <span>Toc</span>
            </div>
            <div class="post-toc">
              <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#easyphp"><span class="toc-text">easyphp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#计算题"><span class="toc-text">计算题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RE"><span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Kaisa"><span class="toc-text">Kaisa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#simple"><span class="toc-text">simple</span></a></li></ol></li></ol>
            </div>
          </div>
           
        </div>
        
      </div>
    </div>
    <!-- swiftype -->
    
    <!-- swiftype -->
  <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
  
  <p id="theme_str" hidden>{&quot;title&quot;:&quot;ios&#39;s blog&quot;,&quot;subtitle&quot;:null,&quot;description&quot;:null,&quot;author&quot;:&quot;ios&quot;,&quot;language&quot;:&quot;zh-CN&quot;,&quot;timezone&quot;:null,&quot;url&quot;:&quot;http://iosmosis.github.io&quot;,&quot;root&quot;:&quot;/&quot;,&quot;permalink&quot;:&quot;:year/:month/:day/:title/&quot;,&quot;permalink_defaults&quot;:null,&quot;source_dir&quot;:&quot;source&quot;,&quot;public_dir&quot;:&quot;public&quot;,&quot;tag_dir&quot;:&quot;tags&quot;,&quot;archive_dir&quot;:&quot;archives&quot;,&quot;category_dir&quot;:&quot;categories&quot;,&quot;code_dir&quot;:&quot;downloads/code&quot;,&quot;i18n_dir&quot;:&quot;:lang&quot;,&quot;skip_render&quot;:null,&quot;new_post_name&quot;:&quot;:title.md&quot;,&quot;default_layout&quot;:&quot;post&quot;,&quot;titlecase&quot;:false,&quot;external_link&quot;:true,&quot;filename_case&quot;:0,&quot;render_drafts&quot;:false,&quot;post_asset_folder&quot;:true,&quot;relative_link&quot;:false,&quot;future&quot;:true,&quot;highlight&quot;:{&quot;enable&quot;:false,&quot;auto_detect&quot;:false,&quot;line_number&quot;:true,&quot;tab_replace&quot;:null},&quot;default_category&quot;:&quot;uncategorized&quot;,&quot;category_map&quot;:null,&quot;tag_map&quot;:null,&quot;date_format&quot;:&quot;YYYY-MM-DD&quot;,&quot;time_format&quot;:&quot;HH:mm:ss&quot;,&quot;per_page&quot;:10,&quot;pagination_dir&quot;:&quot;page&quot;,&quot;theme&quot;:&quot;huhu&quot;,&quot;deploy&quot;:{&quot;type&quot;:&quot;git&quot;,&quot;repository&quot;:&quot;git@github.com:iosmosis/iosmosis.github.io.git&quot;,&quot;branch&quot;:&quot;master&quot;,&quot;message&quot;:&quot;Site updated at {{ now(\&quot;YYYY-MM-DD HH:mm:ss\&quot;) }}&quot;},&quot;ignore&quot;:[],&quot;hljs&quot;:{&quot;enable&quot;:true,&quot;line_number&quot;:&quot;frontend&quot;,&quot;trim_indent&quot;:&quot;backend&quot;,&quot;copy_code&quot;:false},&quot;live2d&quot;:{&quot;enable&quot;:true,&quot;scriptFrom&quot;:&quot;local&quot;,&quot;pluginRootPath&quot;:&quot;live2dw/&quot;,&quot;pluginJsPath&quot;:&quot;lib/&quot;,&quot;pluginModelPath&quot;:&quot;assets/&quot;,&quot;tagMode&quot;:false,&quot;debug&quot;:false,&quot;model&quot;:{&quot;use&quot;:&quot;live2d-widget-model-koharu&quot;},&quot;display&quot;:{&quot;position&quot;:&quot;right&quot;,&quot;width&quot;:150,&quot;height&quot;:300},&quot;mobile&quot;:{&quot;show&quot;:true}},&quot;prism_plugin&quot;:{&quot;mode&quot;:&quot;preprocess&quot;,&quot;theme&quot;:&quot;ghcolors&quot;,&quot;line_number&quot;:false,&quot;custom_css&quot;:&quot;path/to/your/custom.css&quot;},&quot;jsonContent&quot;:{&quot;meta&quot;:false,&quot;pages&quot;:false,&quot;posts&quot;:{&quot;title&quot;:true,&quot;date&quot;:true,&quot;path&quot;:true,&quot;text&quot;:true,&quot;raw&quot;:false,&quot;content&quot;:false,&quot;slug&quot;:false,&quot;updated&quot;:false,&quot;comments&quot;:false,&quot;link&quot;:false,&quot;permalink&quot;:false,&quot;excerpt&quot;:false,&quot;categories&quot;:false,&quot;tags&quot;:true}},&quot;archive_generator&quot;:{&quot;per_page&quot;:10,&quot;yearly&quot;:true,&quot;monthly&quot;:true,&quot;daily&quot;:false},&quot;baidusitemap&quot;:{&quot;path&quot;:&quot;baidusitemap.xml&quot;},&quot;category_generator&quot;:{&quot;per_page&quot;:10},&quot;feed&quot;:{&quot;type&quot;:&quot;atom&quot;,&quot;limit&quot;:20,&quot;hub&quot;:&quot;&quot;,&quot;content&quot;:true,&quot;path&quot;:&quot;atom.xml&quot;},&quot;index_generator&quot;:{&quot;per_page&quot;:10,&quot;order_by&quot;:&quot;-date&quot;},&quot;sitemap&quot;:{&quot;path&quot;:&quot;sitemap.xml&quot;},&quot;tag_generator&quot;:{&quot;per_page&quot;:10},&quot;marked&quot;:{&quot;gfm&quot;:true,&quot;pedantic&quot;:false,&quot;sanitize&quot;:false,&quot;tables&quot;:true,&quot;breaks&quot;:true,&quot;smartLists&quot;:true,&quot;smartypants&quot;:true},&quot;server&quot;:{&quot;port&quot;:4000,&quot;log&quot;:false,&quot;ip&quot;:&quot;0.0.0.0&quot;,&quot;compress&quot;:false,&quot;header&quot;:true},&quot;menu&quot;:{&quot;home&quot;:&quot;/&quot;,&quot;archives&quot;:&quot;/archives&quot;,&quot;about&quot;:&quot;/about&quot;,&quot;Link&quot;:&quot;/link&quot;},&quot;logo&quot;:&quot;/images/logo.png&quot;,&quot;categories_max&quot;:5,&quot;tags_max&quot;:10,&quot;site_search&quot;:true,&quot;rss&quot;:&quot;/atom.xml&quot;,&quot;follow&quot;:{&quot;github&quot;:&quot;https://github.com/iosmosis&quot;,&quot;QQ&quot;:&quot;2417117320&quot;},&quot;search_url&quot;:&quot;/search.xml&quot;,&quot;site_icp&quot;:&quot;&quot;,&quot;site_friends&quot;:{&quot;房间里的小猫咪&quot;:&quot;http://baidu.com&quot;},&quot;share&quot;:[&quot;weibo&quot;,&quot;weixin&quot;,&quot;qqkongjian&quot;,&quot;QQ&quot;,&quot;douban&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;google&quot;],&quot;cdn_module&quot;:{&quot;av_min&quot;:&quot;https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min&quot;,&quot;pjax&quot;:&quot;https://cdn.bootcss.com/jquery.pjax/2.0.1/jquery.pjax.min&quot;,&quot;jquery&quot;:&quot;https://cdn.bootcss.com/jquery/3.4.1/jquery.min&quot;,&quot;confirm&quot;:&quot;https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min&quot;,&quot;fancybox&quot;:&quot;https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min&quot;,&quot;algoliasearch&quot;:&quot;https://cdn.jsdelivr.net/npm/algoliasearch@3.33.0/dist/algoliasearchLite.min&quot;},&quot;baidu_push&quot;:true,&quot;reward&quot;:{&quot;weixin&quot;:&quot;images/weixin.png&quot;,&quot;zhifubao&quot;:&quot;images/zhifubao.png&quot;},&quot;service_worker&quot;:{&quot;open&quot;:false},&quot;valine&quot;:{&quot;API_ID&quot;:&quot;7Y7XlmC1rYmaNjqc4nP11H33-gzGzoHsz&quot;,&quot;API_KEY&quot;:&quot;CohJO6tVqg9R4yI5v5AqKEc7&quot;}}</p>
</html>
<script type="text/javascript">
  window.addEventListener('load', function() {
    ;(adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: 'undefined',
      enable_page_level_ads: true
    })

    window.THEME_CONFIG = JSON.parse(document.getElementById('theme_str').innerText)
    window.loadJs = function(d, m, a) {
      var c = document.getElementsByTagName('head')[0] || document.head || document.documentElement
      var b = document.createElement('script')
      b.defer = true
      b.setAttribute('type', 'text/javascript')
      b.setAttribute('charset', 'UTF-8')
      b.setAttribute('async', 'true')
      b.setAttribute('src', d)
      m && b.setAttribute('data-main', '/scripts/app')
      if (typeof a === 'function') {
        if (window.attachEvent) {
          b.onreadystatechange = function() {
            var e = b.readyState
            if (e === 'loaded' || e === 'complete') {
              b.onreadystatechange = null
              a()
            }
          }
        } else {
          b.onload = a
        }
      }
      c.appendChild(b)
    }
    window.loadJs &&
      window.loadJs('https://cdn.bootcss.com/require.js/2.3.6/require.min.js', true, function() {
        require.config({
          paths: {
            // site
            util: 'util',
            share: 'share',
            search: 'search',
            iconfont: 'iconfont',
            registerSW: 'registerSW',
            valine: ['cdn/Valine.min'],

            // cdn
            av: ['https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min', 'cdn/av-min'],
            pjax: ['https://cdn.bootcss.com/jquery.pjax/2.0.1/jquery.pjax.min', 'cdn/pjax.min'],
            jquery: ['https://cdn.bootcss.com/jquery/3.4.1/jquery.min', 'cdn/jquery.min'],
            confirm: ['https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min', 'cdn/jquery.confirm.min'],
            fancybox: ['https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min', 'cdn/jquery.fancybox.min'],
            algoliasearch: ['https://cdn.jsdelivr.net/npm/algoliasearch@3.33.0/dist/algoliasearchLite.min', 'cdn/algoliasearchLite.min']
          },

          map: {
            '*': {
              css: 'https://cdn.bootcss.com/require-css/0.1.10/css.min.js'
            }
          },

          shim: {
            fancybox: {
              deps: ['css!https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css']
            },
            confirm: {
              deps: ['css!https://cdn.bootcss.com/jquery-confirm/3.3.4/jquery-confirm.min.css']
            }
          },

          // 加载超时
          waitSeconds: 3
        })
      })
  })
</script>

<script>
  ;(function() {
    var bp = document.createElement('script')
    var curProtocol = window.location.protocol.split(':')[0]
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js'
    } else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js'
    }
    var s = document.getElementsByTagName('script')[0]
    s.parentNode.insertBefore(bp, s)
  })()
</script>

<script src="https://cdn.jsdelivr.net/npm/algoliasearch@3.33.0/dist/algoliasearchLite.min.js"></script>
<script></script>
